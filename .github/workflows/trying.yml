name: Try CI
on: push
jobs:
  lighthouse:
    runs-on: ubuntu-latest
    steps:
      - name: Set context
        id: output_context
        env:
          GITHUB_CONTEXT: ${{ toJson(github) }}
        run: |
          LOCAL_RUN_ID=`echo $GITHUB_CONTEXT | jq '.run_id'`
          echo "action_state=$LOCAL_RUN_ID" >> $GITHUB_ENV

      - name: Format score
        id: format_score
        uses: actions/github-script@7a5c598405937d486b0331594b5da2b14db670da # v6
        with:
          script: |
            const text = ${{ env.action_state }};
            console.log('text: ', text)

      - name: Do Work
        env:
          GITHUB_CONTEXT: ${{ toJson(github) }}
        run: |
          echo '::set-output name=FAV_NUMBER::3'
          echo '::set-output name=FAV_COLOR::blue'
          # echo $GITHUB_CONTEXT | jq '.run_id'
          LOCAL_RUN_ID=`echo $GITHUB_CONTEXT | jq '.run_id'`
          echo $LOCAL_RUN_ID
          echo '::set-output name=RUN_ID::{toto}'
          echo "action_state=$LOCAL_RUN_ID" >> $GITHUB_ENV
        id: abc

      - name: Read Output
        run: |
          echo "${{steps.abc.outputs.FAV_NUMBER}}"
          echo "${{steps.abc.outputs.FAV_COLOR}}"
          echo "${{steps.abc.outputs.RUN_ID}}"
          echo "${{ env.action_state }}" # This will output 'yellow'
